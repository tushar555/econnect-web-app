<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>Mahindra_Finance documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	      <link rel="stylesheet" href="../styles/style.css">
    </head>
    <body>

        <div class="navbar navbar-default navbar-fixed-top visible-xs">
            <a href="../" class="navbar-brand">Mahindra_Finance documentation</a>
            <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search"><input type="text" placeholder="Type to search"></div>            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="hidden-xs menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content class">
                   <div class="content-data">











<ol class="breadcrumb">
  <li>Classes</li>
  <li>RegularizeModalData</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
        <li class="active">
            <a href="#info" role="tab" id="info-tab" data-toggle="tab" data-link="info">Info</a>
        </li>
        <li >
            <a href="#source" role="tab" id="source-tab" data-toggle="tab" data-link="source">Source</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="c-info">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>src/app/layout/attendance/attendance.component.ts</code>
        </p>





            <section>
    <h3 id="index">Index</h3>
    <table class="table table-sm table-bordered index-table">
        <tbody>
                <tr>
                    <td class="col-md-4">
                        <h6><b>Properties</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                <a href="#date">date</a>
                            </li>
                            <li>
                                <a href="#inTime">inTime</a>
                            </li>
                            <li>
                                <a href="#outTime">outTime</a>
                            </li>
                            <li>
                                <a href="#remarks">remarks</a>
                            </li>
                            <li>
                                <a href="#shiftBegin">shiftBegin</a>
                            </li>
                            <li>
                                <a href="#shiftEnd">shiftEnd</a>
                            </li>
                        </ul>
                    </td>
                </tr>






        </tbody>
    </table>
</section>


            <section>
    
        <h3 id="inputs">
            Properties
        </h3>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="date"></a>
                        <span class="name">
                            <b>
                            date</b>
                            <a href="#date"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="25" class="link-to-prism">src/app/layout/attendance/attendance.component.ts:25</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="inTime"></a>
                        <span class="name">
                            <b>
                            inTime</b>
                            <a href="#inTime"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="28" class="link-to-prism">src/app/layout/attendance/attendance.component.ts:28</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="outTime"></a>
                        <span class="name">
                            <b>
                            outTime</b>
                            <a href="#outTime"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="29" class="link-to-prism">src/app/layout/attendance/attendance.component.ts:29</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="remarks"></a>
                        <span class="name">
                            <b>
                            remarks</b>
                            <a href="#remarks"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="30" class="link-to-prism">src/app/layout/attendance/attendance.component.ts:30</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="shiftBegin"></a>
                        <span class="name">
                            <b>
                            shiftBegin</b>
                            <a href="#shiftBegin"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="26" class="link-to-prism">src/app/layout/attendance/attendance.component.ts:26</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="shiftEnd"></a>
                        <span class="name">
                            <b>
                            shiftEnd</b>
                            <a href="#shiftEnd"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="27" class="link-to-prism">src/app/layout/attendance/attendance.component.ts:27</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
</section>







    </div>


    <div class="tab-pane fade  tab-source-code" id="c-source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">import { LocalStorageService } from &quot;ngx-store&quot;;
import { Constant } from &quot;./../../services/constant&quot;;
import { CommonService } from &quot;./../../services/common.service&quot;;
import {
  Component,
  OnInit,
  ViewChild,
  NgZone,
  ChangeDetectorRef
} from &quot;@angular/core&quot;;
import { FormBuilder, FormGroup, Validators } from &quot;@angular/forms&quot;;
import * as moment from &quot;moment&quot;;
import { } from &quot;googlemaps&quot;;
import { Ng4LoadingSpinnerService } from &quot;ng4-loading-spinner&quot;;

declare var jquery: any;
declare var $: any;
// declare var google: any;

const MomentRange &#x3D; require(&quot;moment-range&quot;);
const Moment &#x3D; require(&quot;moment&quot;);
const mv &#x3D; MomentRange.extendMoment(Moment);

class RegularizeModalData {
  date: string;
  shiftBegin: string;
  shiftEnd: string;
  inTime: string;
  outTime: string;
  remarks: string;
}

@Component({
  selector: &quot;app-attendance&quot;,
  templateUrl: &quot;./attendance.component.html&quot;,
  styleUrls: [&quot;./attendance.component.scss&quot;]
})
export class AttendanceComponent implements OnInit {
  dateList: any;
  weeklyDataList: any;

  localUserData: any;
  usertype: string &#x3D; &quot;&quot;;
  ddMonth: number;
  conclusionData: any;
  cureentSelectedYear: number;
  selectedYear: number;
  flag: any;
  innerobj: any;
  obj: any;
  status: string;
  oldIndex: any &#x3D; 0;
  IsManager: any;
  // Declarations: {}[];
  regularizeView: boolean;
  isHOEmp: any;
  abc: any;
  sortedArray: any &#x3D; [];
  selectedGrid: any;
  totalDaysInMonth: any &#x3D; [];
  public startDate: any;
  public headerDate: any;
  public listheaderDate: any;
  public currentServerDate;

  public month;
  public year;
  successMessage: any;
  public startWeek;
  public endWeek;

  public monthDate;
  public calendarDate;
  public calendarWeek;
  public weekArray;
  public monthWiseHolidays: Array&lt;any&gt; &#x3D; [];
  public selectedMonth: any;
  holidayCount: number &#x3D; 0;
  public TitleMsg &#x3D; &quot;Attendance&quot;;
  pendingAttendance: any &#x3D; [];
  @ViewChild(&quot;gmap&quot;) gmapElement: any;
  map: google.maps.Map;
  latitude: any &#x3D; &quot;&quot;;
  longitude: any &#x3D; &quot;&quot;;
  signinTime: Date &#x3D; new Date();
  signInType: string;
  serverCurrentdate: any;
  attendanceType: string;
  monthDetail: any;
  public attendanceDateArray;
  public type;
  attendanceInfo: any &#x3D; null;
  tempMonth: any;
  response: any;
  currentMonth: any;
  currentDate: any;
  noRecord: boolean &#x3D; false;
  detailsIcon: string &#x3D; &quot;assets/img/select-date.png&quot;;
  defaultMsg: string &#x3D; &quot;To check date description, select specific date.&quot;;
  calendarView: boolean &#x3D; true;
  listView: boolean &#x3D; false;
  leaveView: boolean &#x3D; false;
  isPermissionSet: boolean &#x3D; false;
  showCaleInfo: boolean &#x3D; false;
  toggleButton: boolean &#x3D; false;
  regularizeData: RegularizeModalData;
  reasonText: any;
  leaveRequest: FormGroup;
  saveDaysMonth: any;
  saveDaysMonthList: any;
  leaveListClassActive: boolean &#x3D; true;
  leaveReqClassActive: boolean &#x3D; false;
  leaveCardClassActive: boolean &#x3D; false;
  maxYear: any;
  minYear: any;
  weeklyData: any;
  weeklyTotal &#x3D; {
    hours: &quot;&quot;,
    minutes: &quot;&quot;
  };
  monthsArray: any &#x3D; [];
  date &#x3D; new Date();
  //leaveCardArr:any[]&#x3D;[];
  leaveCard: any;
  monthNumber: any;
  weekGrid: any &#x3D; [];
  public openFooter: boolean &#x3D; false;
  public openStatus: boolean &#x3D; false;
  noMapAvailable: boolean;
  punchingFlag: any;
  isMapAvailable: boolean;
  //isMarkAttendanceAllowed: any &#x3D; true;
  constructor(
    private _services: CommonService,
    public cd: ChangeDetectorRef,
    private ngZone: NgZone,
    private _storage: LocalStorageService,
    public spinnerService: Ng4LoadingSpinnerService,
    public formBuilder: FormBuilder
  ) {
    this.monthNumber &#x3D; {
      January: &quot;0&quot;,
      February: &quot;1&quot;,
      March: &quot;2&quot;,
      April: &quot;3&quot;,
      May: &quot;4&quot;,
      June: &quot;5&quot;,
      July: &quot;6&quot;,
      August: &quot;7&quot;,
      September: &quot;8&quot;,
      October: &quot;9&quot;,
      November: &quot;10&quot;,
      December: &quot;11&quot;
    };

    this._services.titleMessageSource.next(&quot;Attendance&quot;);
    this.weeklyTotal.hours &#x3D; &quot;&quot;;
    this.weeklyTotal.minutes &#x3D; &quot;&quot;;
    var d &#x3D; new Date();
    this.maxYear &#x3D; d.getFullYear() * 1;
    console.log(&quot;this.MaxYear&quot;, this.maxYear);
    this.minYear &#x3D; this.maxYear - 1;

    //var d&#x3D;new Date();
    //this.saveDaysMonthList&#x3D;moment(d.getMonth()+1, &#x27;MM&#x27;).format(&#x27;MMMM&#x27;) +&#x27; &#x27;+d.getFullYear();
    // console.dir(this.saveDaysMonthList);
    this._services.getUserDetail().then(data &#x3D;&gt; {
      this.localUserData &#x3D; data;
      this.isHOEmp &#x3D; this.localUserData.isHOEmp;
      this.IsManager &#x3D; this.localUserData.IsManager;
      if (this.isHOEmp &#x3D;&#x3D; true) {
        this.usertype &#x3D; &quot;HO&quot;;
      } else {
        this.usertype &#x3D; &quot;RO&quot;;
      }
      this.initializeData();
    });
    // this.isHOEmp &#x3D; this._storage.get(&#x27;username&#x27;).isHOEmp;
    // this.IsManager &#x3D; this._storage.get(&#x27;username&#x27;).IsManager;
    this.regularizeData &#x3D; new RegularizeModalData();

    $(document).ready(function () {
      if ($(&quot;.mydatepicker&quot;).prop(&quot;type&quot;) !&#x3D; &quot;date&quot;) {
        $(&quot;.mydatepicker&quot;).datepicker();
      }
    });

    this.leaveRequest &#x3D; this.formBuilder.group({
      startDate: [&quot;&quot;, [Validators.required]],
      endDate: [&quot;&quot;, [Validators.required]],
      leaveType: [&quot;&quot;, [Validators.required]],
      period: [&quot;&quot;, [Validators.required]],
      comments: [&quot;&quot;, [Validators.required]]
    });
    this.listheaderDate &#x3D; moment();
    this.changeAttendanceList(&quot;&quot;);
  }
  ngAfterViewInit() {
    //this.goToClass();
  }
  goToClass() {
    // $(document).ready(function() {
    setTimeout(() &#x3D;&gt; {
      $(&quot;.fixdiv&quot;).remove();
      //$(&quot;.applyborder&quot;).filter(&quot;:last&quot;).append(&#x60;&lt;div class&#x3D;&quot;fixdiv&quot;   style&#x3D;&quot;position: absolute;top: -17px;right: 0px;width: 150px;background: #fef205;z-index: 99;border-top-left-radius: 4px;border-top-right-radius: 4px;height: 16px;font-size: 11px;font-weight: 600;border: 1px solid #fef205;line-height: 1.2;&quot;&gt;Hours: ${this.weeklyTotal.hours}h ${this.weeklyTotal.minutes}m&lt;/div&gt;&#x60;);
      $(&quot;.applyBorder&quot;)
        .filter(&quot;:last&quot;)
        .append(
          this.isHOEmp &#x3D;&#x3D; true
            ? &#x60;&lt;div class&#x3D;&quot;fixdiv&quot; style&#x3D;&quot;position: absolute;top: -17px;right: 0px;width: 100%;background: #fef205;z-index: 99;border-top-left-radius: 4px;border-top-right-radius: 4px;height: 16px;font-size: 11px;font-weight: 600;border: 1px solid #fef205;line-height: 1.2;&quot;&gt;Hours: ${this.weeklyTotal.hours}h ${this.weeklyTotal.minutes}m&lt;/div&gt;&#x60;
            : &quot;&quot;
        );
    }, 300);
    // });
  }
  showMap(flag) {
    this._services.getService(Constant.getServerDateTime).then(data &#x3D;&gt; {
      this.startDate &#x3D; data;
    });

    this.punchingFlag &#x3D; flag;
    if (flag &#x3D;&#x3D; &quot;IN&quot;) {
      this.getLatLong(
        this.attendanceInfo.LatitudeIn,
        this.attendanceInfo.LongitudeIn
      );
    } else if (flag &#x3D;&#x3D; &quot;OUT&quot;) {
      this.getLatLong(
        this.attendanceInfo.LatitudeOut,
        this.attendanceInfo.LongitudeOut
      );
    }

    $(&quot;document&quot;).ready(function () { });

    if (
      this.attendanceInfo.LatitudeIn !&#x3D;&#x3D; null &amp;&amp;
      this.attendanceInfo.LongitudeIn !&#x3D;&#x3D; null
    ) {
      $(&quot;#attaendancemapModal&quot;).modal(&quot;show&quot;);
      // $(&#x27;#successModal&#x27;).modal(&#x27;hide&#x27;);
      setTimeout(() &#x3D;&gt; {
        var width &#x3D; $(&quot;#modal-body&quot;).width();
        $(&quot;#attendancemap&quot;).css(&quot;width&quot;, width);
      }, 2000);
    }

    //  this.getLatLong(this.attendanceInfo.LatitudeIn, this.attendanceInfo.LongitudeIn);

    //   $(&#x27;#attaendancemapModal&#x27;).modal(&#x27;show&#x27;);
    //   $(&#x27;#successModal&#x27;).modal(&#x27;hide&#x27;);
    //   setTimeout(() &#x3D;&gt; {
    //     var width &#x3D; $(&#x27;#modal-body1&#x27;).width();
    //     $(&quot;#attendancemap&quot;).css(&quot;width&quot;, width);
    //   }, 2000)
  }
  initializeData() {
    // this.month &#x3D; moment().month();
    // this.year &#x3D; moment().year();
    this.spinnerService.show();
    this.currentDate &#x3D; new Date();
    this.selectedMonth &#x3D; this.month + 1;
    // this.weekArray &#x3D; [&#x27;M&#x27;, &#x27;T&#x27;, &#x27;W&#x27;, &#x27;T&#x27;, &#x27;F&#x27;, &#x27;S&#x27;, &#x27;S&#x27;];
    this.weekArray &#x3D; [&quot;S&quot;, &quot;M&quot;, &quot;T&quot;, &quot;W&quot;, &quot;T&quot;, &quot;F&quot;, &quot;S&quot;];
    this.latitude &#x3D; &quot;&quot;;
    this.longitude &#x3D; &quot;&quot;;
    this.startDate &#x3D; this._services.serverDate;

    //**************************************** */

    this._services.getService(Constant.getServerDateTime).then(data &#x3D;&gt; {
      this.startDate &#x3D; data;
      this.headerDate &#x3D; data;
      this.listheaderDate &#x3D; data;
      this.currentServerDate &#x3D; data;
      if (data !&#x3D; null) {
        let date &#x3D; moment(this.serverCurrentdate).date();
        this.month &#x3D; moment(this.serverCurrentdate).month();
        this.year &#x3D; moment(this.serverCurrentdate).year();
        this.weekArray &#x3D; [&quot;S&quot;, &quot;M&quot;, &quot;T&quot;, &quot;W&quot;, &quot;T&quot;, &quot;F&quot;, &quot;S&quot;];
        console.log(&quot;Year&quot;, this.year);
        console.log(&quot;Month&quot;, this.month);
        this.selectedYear &#x3D; this.year;
        this.ddMonth &#x3D; this.month;
        this.get_calendar(this.year, this.month);
      }
    });

    //this.startDate &#x3D; this._services.serverDate;
    this.checkMarkAttendanceType();
    this.findMe();
    // this.get_calendar(this.year, this.month, this.startDate);
    // this.spinnerService.hide();
  }

  ngOnInit() { }

  findMe() {
    if (navigator.geolocation) {
      navigator.geolocation.getCurrentPosition(
        position &#x3D;&gt; {
          // this.showPosition(position);
          this.isPermissionSet &#x3D; true;
          console.log(position);
        },
        error &#x3D;&gt; {
          console.log(error.code);
          this.setGeolocationErrorMsg(error);
          $(&quot;#successModal&quot;).modal(&quot;show&quot;);
        }
      );
    } else {
      alert(&quot;Geolocation is not supported by this browser.&quot;);
    }
  }

  setGeolocationErrorMsg(error) {
    console.log(&quot;Error&quot;, error);

    switch (error.code) {
      case 1:
        this.successMessage &#x3D;
          &quot;User denied the request for Geolocation. To enable geolocation, check browser&#x27;s settings&quot;; //&quot;You denied Geolocation, Please allow map to get your location.&quot;
        this.isPermissionSet &#x3D; false;
        break;
      case 2:
        this.successMessage &#x3D;
          &quot;Location information is unavailable. To enable geolocation, check browser&#x27;s settings.&quot;; //&quot;Unable to retrieve your location&quot;
        this.isPermissionSet &#x3D; false;
        break;
      case 3:
        this.successMessage &#x3D; &quot;The request to get user location has timed out.&quot;; //&quot;Unable to retrieve your location&quot;
        this.isPermissionSet &#x3D; false;
        break;
    }
  }

  get_calendar(year, month) {
    //startDate&#x3D;moment(this.serverCurrentdate).date();
    this.tempMonth &#x3D; month;
    this.year &#x3D; year;
    //this.selectedYear &#x3D; year;
    //this.ddMonth &#x3D; month;
    this.totalDaysInMonth &#x3D; [];

    //var calendarDateValue &#x3D; moment(startDate).format(&quot;YYYY-MM-DD&quot;);
    var vm &#x3D; this;
    console.log(&quot;new vm: &quot;, vm);
    //console.log(&quot;calendarDateValue: &quot;,calendarDateValue);
    var getDateMonthCall &#x3D; function () {
      vm.getMonthDate(vm.startWeek, vm.endWeek, { y: year, M: month });
      // vm.calendarEventDate &#x3D;
      // this.showCaleInfo &#x3D; true;
    };

    //  console.log(&#x27;HELLO&#x27;,moment({ y: year, M: month }).isoWeekday(0).startOf(&#x27;week&#x27;).get(&#x27;isoWeek&#x27;));
    // console.log(&#x27;HELLO11&#x27;, moment({ y: year, M: month }).startOf(&#x27;month&#x27;).get(&#x27;isoWeek&#x27;));

    //***************************OLD********************** */
    this.startWeek &#x3D; moment({ y: year, M: month })
      .startOf(&quot;month&quot;)
      .get(&quot;isoWeek&quot;);
    this.endWeek &#x3D; moment({ y: year, M: month })
      .endOf(&quot;month&quot;)
      .get(&quot;isoWeek&quot;);

    //***************************NEW********************** */
    // this.startWeek &#x3D; moment({ y: year, M: month }).isoWeekday(0).startOf(&#x27;week&#x27;).get(&#x27;isoWeek&#x27;);
    //this.endWeek &#x3D;  moment({ y: year, M: month }).isoWeekday(0).endOf(&#x27;week&#x27;).get(&#x27;isoWeek&#x27;);

    this.getCalendarEvent(getDateMonthCall);
  }

  getMonthDate(startweek, endWeek, momentYear) {
    //console.log(&quot;my getMonthDate: &quot;+startweek+&quot;|&quot;+endWeek);
    this.currentMonth &#x3D; momentYear.M;

    //console.log(&quot;1call&quot;, this.currentMonth);
    console.log(&quot;monthDetail: &quot;, this.monthDetail);
    if (startweek &#x3D;&#x3D; 53) {
      ++endWeek;
    }
    if (momentYear.M &#x3D;&#x3D; 0) {
      startweek &#x3D; 1;
    }
    if (endWeek &#x3D;&#x3D; 1) {
      endWeek &#x3D; 53;
    }

    this.monthDate &#x3D; [];
    this.calendarDate &#x3D; [];
    console.log(&quot;Start Week&quot;, startweek);
    console.log(&quot;endWeek Week&quot;, endWeek);
    console.log(&quot;endWeek Week&quot;, this.monthDate);

    for (let i &#x3D; startweek; i &lt;&#x3D; endWeek + 1; i++) {
      // alert(&quot;call&quot;);

      this.monthDate.push([
        Array(7)
          .fill(0)
          .map((n, j) &#x3D;&gt;
            moment(momentYear)
              .set(&quot;week&quot;, i)
              .startOf(&quot;week&quot;)
              .clone()
              .add(n + j, &quot;day&quot;)
              .toDate()
          )
      ]);
      console.log(&quot;monthDateWeek&quot;, this.monthDate);
    }
    for (let c &#x3D; 0; c &lt; this.monthDetail.length; c++) {
      this.signinTime.getMonth() + 1;
      var check &#x3D; moment(this.monthDetail[c].AttendanceDate); //, &#x27;YYYY/MM/DD&#x27;
      console.log(check);
      var day &#x3D; check.format(&quot;D&quot;);
      this.monthDetail[c].date &#x3D; day;
    }

    for (let j &#x3D; 0; j &lt; this.monthDate.length; j++) {
      this.calendarWeek &#x3D; [];
      let event: any;
      for (let k &#x3D; 0; k &lt; this.monthDate[j][0].length; k++) {
        let date &#x3D; this.monthDate[j][0][k];
        let currDate &#x3D; &quot;no-current-date&quot;;

        if (momentYear.M !&#x3D; this.monthDate[j][0][k].getMonth()) {
          currDate &#x3D; &quot;muted&quot;;
        }
        let finddtt &#x3D; moment(this.monthDate[j][0][k]).format(
          &quot;YYYY-MM-DDT00:00:00&quot;
        );
        let calendarIndex &#x3D; this.monthDetail.findIndex(
          x &#x3D;&gt; x.AttendanceDate &#x3D;&#x3D; finddtt
        );
        if (
          (calendarIndex &#x3D;&#x3D; 0 || calendarIndex !&#x3D; false) &amp;&amp;
          calendarIndex !&#x3D; -1
        ) {
          event &#x3D; this.monthDetail[calendarIndex];
        } else if (calendarIndex &#x3D;&#x3D;&#x3D; false) {
          event &#x3D; null;
        }
        if (
          moment(moment(this.monthDate[j][0][k]).format(&quot;YYYY-MM-DD&quot;)).diff(
            moment(this.signinTime).format(&quot;YYYY-MM-DD&quot;)
          ) &#x3D;&#x3D;&#x3D; 0
        ) {
          currDate &#x3D; &quot;currentDate&quot;;
        }
        let flag: boolean;
        if (
          parseInt(this.monthDate[j][0][k].getMonth()) &#x3D;&#x3D;&#x3D;
          parseInt(momentYear.M)
        ) {
          flag &#x3D; true;
        } else {
          flag &#x3D; false;
        }

        if (event) {
          this.calendarWeek.push({
            attendance_date: event,
            cdate: date,
            currentDate: currDate,
            monthData: parseInt(this.monthDate[j][0][k].getMonth()),
            dateflag: flag
          });
        }
      }
      if (this.calendarWeek.length &gt; 0) {
        this.calendarDate.push(this.calendarWeek);
      }
    }
    function inArray(needle, monthDetail) {
      //var length &#x3D; haystack.length;

      for (var i &#x3D; 0; i &lt; monthDetail.length; i++) {
        if (monthDetail[i].date &#x3D;&#x3D; needle) {
          return i;
        }
      }
      return false;
    }

    if (this.monthWiseHolidays.length &gt; 0) {
      this.holidayCount &#x3D; this.monthWiseHolidays.length;
    }
    if (moment().get(&quot;month&quot;) &#x3D;&#x3D; moment(this.date).get(&quot;month&quot;)) {
      this.getCurrentWeek().then(dt &#x3D;&gt; {
        console.log(dt);
        this.showWeekDetails(dt);
      });
    } else {
      console.log(moment(this.date).get(&quot;month&quot;));
      this.showWeekDetails(0);
    }

    this.intializeTotalDateArray(this.calendarDate);
    console.log(&quot;CALRENDAER&quot;, this.calendarDate);
    this.spinnerService.hide();
  }

  intializeTotalDateArray(calenderDate) {
    this.totalDaysInMonth &#x3D; [];
    this.totalDaysInMonth.splice(0, this.totalDaysInMonth.length);
    console.log(&quot;TOTAL INITIALIZE ARRAY&quot;, calenderDate);
    calenderDate.forEach(item &#x3D;&gt; {
      item.forEach(innerItem &#x3D;&gt; {
        this.totalDaysInMonth.push(innerItem);
      });
    });
    this.checkCurrentDayWeek();
  }

  checkCurrentDayWeek() {
    console.log(&quot;Total Array&quot;, this.totalDaysInMonth);
    console.log(&quot;Current date&quot;, this.startDate);

    let foundIndex &#x3D; this.totalDaysInMonth.findIndex(
      obj &#x3D;&gt;
        moment(this.startDate).format(&quot;DD-MM-YYYY&quot;) &#x3D;&#x3D;
        moment(obj.cdate).format(&quot;DD-MM-YYYY&quot;)
    );
    console.log(foundIndex);
    switch (true) {
      case foundIndex &gt;&#x3D; 0 &amp;&amp; foundIndex &lt; 7:
        this.showWeekDetails(0);
        break;
      case foundIndex &gt;&#x3D; 7 &amp;&amp; foundIndex &lt; 14:
        this.showWeekDetails(1);
        break;
      case foundIndex &gt;&#x3D; 14 &amp;&amp; foundIndex &lt; 21:
        this.showWeekDetails(2);
        break;
      case foundIndex &gt;&#x3D; 21 &amp;&amp; foundIndex &lt; 28:
        this.showWeekDetails(3);
        break;
      case foundIndex &gt;&#x3D; 28 &amp;&amp; foundIndex &lt; 35:
        this.showWeekDetails(4);
        break;
      case foundIndex &gt;&#x3D; 28 &amp;&amp; foundIndex &lt; 35:
        this.showWeekDetails(4);
        break;
    }
  }
  getCurrentWeek() {
    let promise &#x3D; new Promise((resolve, reject) &#x3D;&gt; {
      let i &#x3D; 0;
      if (this.weeklyData) {
        this.weeklyData.forEach(week &#x3D;&gt; {
          week.forEach(day &#x3D;&gt; {
            console.log(moment(day.AttendanceDate).format(&quot;DD-MM-YYYY&quot;));
            if (
              moment(day.AttendanceDate).format(&quot;DD-MM-YYYY&quot;) &#x3D;&#x3D;
              moment().format(&quot;DD-MM-YYYY&quot;)
            ) {
              resolve(i);
            }
          });
          i++;
        });
      }
    });
    return promise;
  }

  showWeekDetails(week) {
    this.calculateWeeklyHours(week);
    this.selectedGrid &#x3D; week;
    console.log(&quot;foundIndex&quot;, this.selectedGrid);
    // this.tempArray &#x3D; this.weekList[week];
    switch (true) {
      case week &#x3D;&#x3D;&#x3D; 0:
        this.sortedArray &#x3D; this.totalDaysInMonth.slice(0, 7);
        break;
      case week &#x3D;&#x3D;&#x3D; 1:
        this.sortedArray &#x3D; this.totalDaysInMonth.slice(7, 14);
        break;
      case week &#x3D;&#x3D;&#x3D; 2:
        this.sortedArray &#x3D; this.totalDaysInMonth.slice(14, 21);
        break;
      case week &#x3D;&#x3D;&#x3D; 3:
        this.sortedArray &#x3D; this.totalDaysInMonth.slice(21, 28);
        break;
      case week &#x3D;&#x3D;&#x3D; 4:
        this.sortedArray &#x3D; this.totalDaysInMonth.slice(28);
        break;
      case week &#x3D;&#x3D;&#x3D; 5:
        this.sortedArray &#x3D; this.totalDaysInMonth.slice(28);
        break;
    }
    console.log(&quot;weekdata&quot;, this.weeklyData[this.selectedGrid]);
    this.calculateWeeklyTime(week);
  }
  calculateWeeklyHours(week) {
    let curWeekData &#x3D; this.weeklyData[week];
    let totalHours &#x3D; 0;
    curWeekData.forEach(el &#x3D;&gt; {
      if (el.TimeIn &amp;&amp; el.TimeOut) {
        let start &#x3D; moment(el.TimeIn);
        let end &#x3D; moment(el.TimeOut);
        let duration &#x3D; moment.duration(end.diff(start));
        totalHours +&#x3D; duration.asHours();
      }
    });
    let hrs &#x3D; Math.floor(totalHours);
    let min &#x3D; totalHours.toString().split(&quot;.&quot;)[1];
    min &#x3D; (parseFloat(&quot;0.&quot; + min) * 60).toString();
    min &#x3D; parseInt(min).toString();
    let totalHoursObj &#x3D; {};
    totalHoursObj[&quot;totalHours&quot;] &#x3D; totalHours;
    totalHoursObj[&quot;hours&quot;] &#x3D; hrs;
    totalHoursObj[&quot;minutes&quot;] &#x3D; parseInt(min);
    this.weeklyTotal.hours &#x3D; hrs.toString();
    this.weeklyTotal.minutes &#x3D; min;
    console.log(totalHoursObj);
    this.goToClass();
  }
  weeklySegregation() {
    let weeklyData &#x3D; [];
    let curWeek &#x3D; 0;
    weeklyData[0] &#x3D; [];
    console.log(&quot;this.monthDetail&quot;, this.monthDetail);

    for (let i &#x3D; 0; i &lt; this.monthDetail.length; i++) {
      weeklyData[curWeek].push(this.monthDetail[i]);
      // if (i &lt; this.monthDetail.length - 1 &amp;&amp; moment(this.monthDetail[i + 1].AttendanceDate).day() &#x3D;&#x3D; 0) {
      if (
        i &lt; this.monthDetail.length - 1 &amp;&amp;
        (moment(this.monthDetail[i + 1].AttendanceDate).day() &#x3D;&#x3D; 0 ||
          (moment(this.monthDetail[i].AttendanceDate).date() &#x3D;&#x3D; 15 &amp;&amp;
            moment(this.monthDetail[i].AttendanceDate).day() !&#x3D; 0))
      ) {
        curWeek++;
        weeklyData[curWeek] &#x3D; [];
      }
    }
    return weeklyData;
  }

  checkWeekActive(d) {
    let flg &#x3D; false;
    // console.log(&quot;date:: &quot;, d);
    // console.log(&quot;in weeklydata: &quot;, this.weeklyData);
    if (this.weeklyData &amp;&amp; this.selectedGrid &gt; -1) {
      // console.log(this.selectedGrid);
      // console.log(this.weeklyData[this.selectedGrid]);
      // console.log(d.attendance_date.AttendanceDate);
      for (let el of this.weeklyData[this.selectedGrid]) {
        if (el.AttendanceDate &#x3D;&#x3D; d.attendance_date.AttendanceDate) {
          flg &#x3D; true;
          break;
        }
      }
    }
    return flg;
  }

  checkDate(d) {
    if (this.sortedArray !&#x3D;&#x3D; undefined) {
      //console.log(&#x27;FLAG&#x27;, this.tempArray);

      const checkDay &#x3D; obj &#x3D;&gt;
        moment(obj.cdate).calendar() &#x3D;&#x3D;&#x3D; moment(d.cdate).calendar() &amp;&amp;
        obj.currentDate !&#x3D;&#x3D; &quot;muted&quot; &amp;&amp;
        obj.dateflag;
      //  console.log(&#x27;CHECK Day&#x27;, this.tempArray.some(checkDay));

      if (this.sortedArray.some(checkDay)) {
        // console.log(&#x27;DateTrue&#x27;, d);
        //console.log(&#x27;True&#x27;, checkDay);

        return true;
      } else {
        //console.log(&#x27;False&#x27;, checkDay);

        return false;
      }
    }
  }
  arrayOne(): any[] {
    return Array(5);
  }

  onMonthChange(ddMonth, selectedYear) {
    this.spinnerService.show();
    console.log(ddMonth + &quot;|&quot; + selectedYear);
    this.attendanceInfo &#x3D; null;
    this.toggleButton &#x3D; false;
    this.noRecord &#x3D; false;
    this.detailsIcon &#x3D; &quot;assets/img/select-date.png&quot;;
    this.defaultMsg &#x3D; &quot;To check date description, select specific date.&quot;;
    this.holidayCount &#x3D; 0;
    this.totalDaysInMonth &#x3D; [];

    this.headerDate &#x3D; moment(
      this.selectedYear + &quot;-&quot; + this.ddMonth + &quot;-01&quot;
    ).toDate();
    console.log(&quot;new header: &quot; + this.headerDate);
    let mstartDate &#x3D; moment(this.headerDate);
    this.get_calendar(this.selectedYear, this.ddMonth);

    // this.get_calendar(mstartDate.get(&#x27;year&#x27;), mstartDate.get(&#x27;month&#x27;));
    //this.selectedMonth &#x3D; mstartDate.get(&#x27;month&#x27;) + 1;
    // this.listheaderDate &#x3D; moment(this.listheaderDate).subtract(1, &#x27;months&#x27;).toDate();
    // let mstartDate &#x3D; moment(this.listheaderDate);
    //this.getMonthDetail(selectedYear, ddMonth);
    // this.get_calendar(mstartDate.get(&#x27;year&#x27;), mstartDate.get(&#x27;month&#x27;), this.listheaderDate);
    //this.selectedMonth &#x3D; mstartDate.get(&#x27;month&#x27;) + 1;
  }
  applyDateAll() {
    setTimeout(() &#x3D;&gt; {
      var self &#x3D; this;
      var dateformat &#x3D; self.saveDaysMonth.split(&quot; &quot;);
      console.log(&quot;*******dateformat&quot;, this.startDate);

      dateformat[0] &#x3D; self.monthNumber[dateformat[0]];
      var currentDate &#x3D; new Date();
      console.dir(currentDate);
      if (self.saveDaysMonth !&#x3D;&#x3D; &quot; &quot;) {
        $(&quot;.startDateAll&quot;).val(self.saveDaysMonth);
      }

      //var defaultDate &#x3D; new Date(&#x27;1/12/2019&#x27;);

      $(document).ready(function () {
        $(&quot;.imageclick&quot;).on(&quot;click&quot;, function (e) {
          $(&quot;.startDateAll&quot;).datepicker(&quot;show&quot;);
        });

        $(&quot;.startDateAll&quot;).datepicker({
          changeMonth: true,
          changeYear: true,
          showButtonPanel: true,
          dateFormat: &quot;MM yy&quot;,
          yearRange: self.minYear + &quot;:&quot; + self.maxYear,
          maxDate: &quot;0&quot;,
          minDate: new Date(&#x60;${self.minYear}-04-01&#x60;),
          // defaultDate: defaultDate ,
          beforeShow: function (input, inst) {
            var dateformat1 &#x3D; self.saveDaysMonth.split(&quot; &quot;);
            dateformat1[0] &#x3D; self.monthNumber[dateformat1[0]];
            var string &#x3D;
              dateformat1[0] * 1 + 1 + &quot;/&quot; + &quot;01&quot; + &quot;/&quot; + dateformat1[1];
            var defaultDate &#x3D; new Date(string);

            $(this).datepicker(&quot;option&quot;, &quot;defaultDate&quot;, defaultDate);
            $(&quot;.startDateAll&quot;).val(self.saveDaysMonth);
          },
          onClose: function (dateText, inst) {
            var date &#x3D; $(this).datepicker(
              &quot;setDate&quot;,
              new Date(inst.selectedYear, inst.selectedMonth, 1)
            );
            date &#x3D; date[0].value;
            // $(&quot;#startDate1&quot;).datepicker(&quot;option&quot;, &quot;defaultDate&quot;, date);
            console.dir(date);

            if (date &#x3D;&#x3D; self.saveDaysMonth) {
              return false;
            }
            date &#x3D; date.split(&quot; &quot;);
            self.DatePickerMethod(date[1], self.monthNumber[date[0]]);
            self.getMonthAttendance(self.monthNumber[date[0]] * 1 + 1, date[1]);
            //self.getMonthAttendance&#x3D;$(this).datepicker(&#x27;setDate&#x27;, new Date(inst.selectedYear, inst.selectedMonth, 1))[0].value;
            self.saveDaysMonth &#x3D; $(this).datepicker(
              &quot;setDate&quot;,
              new Date(inst.selectedYear, inst.selectedMonth, 1)
            )[0].value;
          }
        });
        $.datepicker._gotoToday &#x3D; function (id) {
          $(id)
            .datepicker(&quot;setDate&quot;, new Date())
            .datepicker(&quot;hide&quot;)
            .blur();
        };
      });
    }, 0);
  }
  // applyDate() {
  //   setTimeout(() &#x3D;&gt; {
  //     var self &#x3D; this;
  //     var dateformat&#x3D;self.saveDaysMonth.split(&#x27; &#x27;);
  //     dateformat[0]&#x3D;self.monthNumber[dateformat[0]];

  //     if(self.saveDaysMonth){
  //       $(&#x27;#startDate1&#x27;).val(self.saveDaysMonth);
  //     }
  //     console.dir(self.saveDaysMonth);
  //     $(document).ready(function () {
  //       $(&#x27;#startDate1&#x27;).datepicker({
  //         changeMonth: true,
  //         changeYear: true,
  //         showButtonPanel: true,
  //         dateFormat: &#x27;MM yy&#x27;,
  //         maxDate: &#x27;0&#x27;,
  //         //defaultDate: new Date(dateformat[1], dateformat[0], 1),
  //         onClose: function (dateText, inst) {

  //           var date&#x3D;$(this).datepicker(&#x27;setDate&#x27;, new Date(inst.selectedYear, inst.selectedMonth, 1));
  //               date&#x3D;date[0].value;
  //              // $(&quot;#startDate1&quot;).datepicker(&quot;option&quot;, &quot;defaultDate&quot;, date);
  //               console.dir(date);
  //               console.dir(self.saveDaysMonth);
  //                   if(date &#x3D;&#x3D;  self.saveDaysMonth){
  //                     return false;
  //                   }
  //               date&#x3D;date.split(&#x27; &#x27;)
  //              self.DatePickerMethod(date[1],self.monthNumber[date[0]]);
  //              self.saveDaysMonth&#x3D;$(this).datepicker(&#x27;setDate&#x27;, new Date(inst.selectedYear, inst.selectedMonth, 1))[0].value;
  //         }
  //       });
  //     });
  //   }, 0)
  // }

  DatePickerMethod(year, month) {
    this.spinnerService.show();
    console.dir(year + &quot;  &quot; + month);
    // console.log(ddMonth + &quot;|&quot; + selectedYear);
    this.selectedYear &#x3D; year;
    this.ddMonth &#x3D; month;
    this.attendanceInfo &#x3D; null;
    this.toggleButton &#x3D; false;
    this.noRecord &#x3D; false;
    this.detailsIcon &#x3D; &quot;assets/img/select-date.png&quot;;
    this.defaultMsg &#x3D; &quot;To check date description, select specific date.&quot;;
    this.holidayCount &#x3D; 0;
    this.totalDaysInMonth &#x3D; [];

    // this.headerDate &#x3D; moment(this.selectedYear + &quot;-&quot; + this.ddMonth + &quot;-01&quot;).toDate();
    // console.log(&quot;new header: &quot; + this.headerDate);
    // let mstartDate &#x3D; moment(this.headerDate);
    this.get_calendar(this.selectedYear, this.ddMonth);
  }
  previousYear() {
    console.dir(this.monthNumber);
    this.selectedYear -&#x3D; 1;
    console.log(&quot;this.selectedYear&quot;, this.selectedYear);
    this.onMonthChange(this.ddMonth, this.selectedYear);
  }
  nextYear() {
    this.selectedYear +&#x3D; 1;
    console.log(&quot;this.selectedYear&quot;, this.selectedYear);
    this.onMonthChange(this.ddMonth, this.selectedYear);
  }
  previousMonth(type?) {
    this.attendanceInfo &#x3D; null;
    this.toggleButton &#x3D; false;
    this.noRecord &#x3D; false;
    this.detailsIcon &#x3D; &quot;assets/img/select-date.png&quot;;
    this.defaultMsg &#x3D; &quot;To check date description, select specific date.&quot;;
    this.holidayCount &#x3D; 0;
    this.totalDaysInMonth &#x3D; [];
    if (type !&#x3D; &quot;list&quot; || type &#x3D;&#x3D; undefined) {
      this.headerDate &#x3D; moment(this.headerDate)
        .subtract(1, &quot;months&quot;)
        .toDate();
      let mstartDate &#x3D; moment(this.headerDate);
      this.get_calendar(mstartDate.get(&quot;year&quot;), mstartDate.get(&quot;month&quot;));
      this.selectedMonth &#x3D; mstartDate.get(&quot;month&quot;) + 1;
    } else {
      this.listheaderDate &#x3D; moment(this.listheaderDate)
        .subtract(1, &quot;months&quot;)
        .toDate();
      let mstartDate &#x3D; moment(this.listheaderDate);
      this.getMonthDetail(mstartDate.get(&quot;year&quot;), mstartDate.get(&quot;month&quot;));
      // this.get_calendar(mstartDate.get(&#x27;year&#x27;), mstartDate.get(&#x27;month&#x27;), this.listheaderDate);
      this.selectedMonth &#x3D; mstartDate.get(&quot;month&quot;) + 1;
    }
  }

  nextMonth(type?) {
    this.attendanceInfo &#x3D; null;
    this.toggleButton &#x3D; false;
    this.noRecord &#x3D; false;
    this.detailsIcon &#x3D; &quot;assets/img/select-date.png&quot;;
    this.defaultMsg &#x3D; &quot;To check date description, select specific date.&quot;;
    this.holidayCount &#x3D; 0;

    this.totalDaysInMonth &#x3D; [];

    if (type !&#x3D; &quot;list&quot; || type &#x3D;&#x3D; undefined) {
      this.headerDate &#x3D; moment(this.headerDate)
        .add(1, &quot;months&quot;)
        .toDate();
      let mstartDate &#x3D; moment(this.headerDate);
      this.get_calendar(mstartDate.get(&quot;year&quot;), mstartDate.get(&quot;month&quot;));
      this.selectedMonth &#x3D; mstartDate.get(&quot;month&quot;) + 1;
    } else {
      this.listheaderDate &#x3D; moment(this.listheaderDate)
        .add(1, &quot;months&quot;)
        .toDate();
      let mstartDate &#x3D; moment(this.listheaderDate);
      this.getMonthDetail(mstartDate.get(&quot;year&quot;), mstartDate.get(&quot;month&quot;));
      // this.get_calendar(mstartDate.get(&#x27;year&#x27;), mstartDate.get(&#x27;month&#x27;), this.listheaderDate);
      this.selectedMonth &#x3D; mstartDate.get(&quot;month&quot;) + 1;
    }
  }

  openMap() {
    //this.isPermissionSet
    if (this.isPermissionSet) {
      console.dir(&quot;inside permission&quot;);
      this._services.getService(Constant.getServerDateTime).then(data &#x3D;&gt; {
        this.startDate &#x3D; data;
      });
      this.getLatLong(&quot;&quot;, &quot;&quot;);
      $(&quot;document&quot;).ready(function () { });

      $(&quot;#mapModal&quot;).modal(&quot;show&quot;);
      $(&quot;#successModal&quot;).modal(&quot;hide&quot;);
      setTimeout(() &#x3D;&gt; {
        var width &#x3D; $(&quot;#modal-body&quot;).width();
        $(&quot;#map&quot;).css(&quot;width&quot;, width);
        console.dir($(&quot;#modal-body&quot;).css(&quot;width&quot;));
      }, 2000);
    } else {
      $(&quot;#mapModal&quot;).modal(&quot;hide&quot;);
      $(&quot;#successModal&quot;).modal(&quot;show&quot;);
    }
  }
  openInfoModal() {
    $(&quot;#informationModal&quot;).modal(&quot;show&quot;);
  }

  // applyDateList() {
  //   setTimeout(() &#x3D;&gt; {
  //     var self &#x3D; this;
  //     if(self.saveDaysMonthList){
  //       //alert(self.saveDaysMonthList);
  //       $(&#x27;#startDateList&#x27;).val(self.saveDaysMonthList);
  //       $(&#x27;#startDate&#x27;).val(self.saveDaysMonthList);
  //     }
  //     $(document).ready(function () {
  //       $(&#x27;#startDateList&#x27;).datepicker({
  //         changeMonth: true,
  //         changeYear: true,
  //         showButtonPanel: true,
  //         dateFormat: &#x27;MM yy&#x27;,
  //         maxDate: &#x27;0&#x27;,
  //         onClose: function (dateText, inst) {
  //           var date&#x3D;$(this).datepicker(&#x27;setDate&#x27;, new Date(inst.selectedYear, inst.selectedMonth, 1));
  //               date&#x3D;date[0].value;
  //               console.dir(date);
  //               console.dir(self.saveDaysMonthList);
  //                   if(date &#x3D;&#x3D;  self.saveDaysMonthList){
  //                     return false;
  //                   }
  //               date&#x3D;date.split(&#x27; &#x27;)
  //             // self.DatePickerMethod(date[1],self.monthNumber[date[0]]);
  //             self.getMonthAttendance(self.monthNumber[date[0]]*1+1,date[1]);
  //              self.saveDaysMonthList&#x3D;$(this).datepicker(&#x27;setDate&#x27;, new Date(inst.selectedYear, inst.selectedMonth, 1))[0].value;
  //         }
  //       });
  //     });
  //   }, 0)
  // }

  changeAttendanceList(direction) {
    if (direction &#x3D;&#x3D; &quot;next&quot;) {
      this.listheaderDate &#x3D; moment(this.listheaderDate)
        .add(1, &quot;months&quot;)
        .toDate();
    } else if (direction &#x3D;&#x3D; &quot;prev&quot;) {
      this.listheaderDate &#x3D; moment(this.listheaderDate)
        .subtract(1, &quot;months&quot;)
        .toDate();
    }
    let month &#x3D; moment(this.listheaderDate).get(&quot;months&quot;) + 1;
    let year &#x3D; moment(this.listheaderDate).get(&quot;years&quot;);
    console.log(&quot;month: &quot;, month, &quot;Year: &quot;, year);
    this.getMonthAttendance(month, year);
  }

  getMonthAttendance(month, year) {
    this.spinnerService.show();
    this._services.getUserDetail().then((data: any) &#x3D;&gt; {
      console.log(data);
      let params &#x3D; {
        month: month,
        year: year,
        tokenid: data.TokenId
      };
      this._services.postService(Constant.MonthAttendanceNew, params).then(
        response &#x3D;&gt; {
          this.dateList &#x3D; response[&quot;data&quot;];

          this.weeklyDataList &#x3D; this.weeklySegregationList();
          // this.weeklyDataList.push(this.calendarDate);
          // this.setWeekGrid();
          console.log(this.weeklyDataList);
          console.log(moment().get(&quot;month&quot;) + 1);
          console.log(moment(this.date).get(&quot;month&quot;));
          // if (moment().get(&#x27;month&#x27;)+1 &#x3D;&#x3D; month) {
          if (moment().get(&quot;month&quot;) &#x3D;&#x3D; moment(this.date).get(&quot;month&quot;)) {
            this.getCurrentWeek().then(dt &#x3D;&gt; {
              console.log(dt);
              this.showWeekDetails(dt);
            });
          } else {
            console.log(moment(this.date).get(&quot;month&quot;));
            this.showWeekDetails(0);
          }
        },
        error &#x3D;&gt; {
          console.log(&quot;Error: &quot;, error);
        }
      );
    });
  }

  setWeekGrid() {
    let weekDataLen &#x3D; this.weeklyDataList.length;
    let lastWeek &#x3D; this.weeklyDataList[weekDataLen - 1];
    console.log(&quot;lastweek&quot;, lastWeek);

    if (lastWeek &#x3D;&#x3D;&#x3D; undefined || lastWeek &#x3D;&#x3D;&#x3D; &quot;&quot;) {
      this.weekGrid &#x3D; Array(weekDataLen - 1);
      console.log(&quot;lastweek undefined&quot;, lastWeek);
      return false;
    } else {
      lastWeek.forEach(element &#x3D;&gt; { });
    }
  }

  weeklySegregationList() {
    let weeklyData &#x3D; [];
    let curWeek &#x3D; 0;
    weeklyData[0] &#x3D; [];
    for (let i &#x3D; 0; i &lt; this.dateList.length; i++) {
      if (
        moment(this.dateList[i].AttendanceDate).date() &#x3D;&#x3D;
        moment(this.serverCurrentdate).date()
      ) {
        console.log(&quot;in if&quot;);
        this.dateList[i].currentDate &#x3D; true;
      } else {
        this.dateList[i].currentDate &#x3D; false;
      }
      weeklyData[curWeek].push(this.dateList[i]);
      if (
        i &lt; this.dateList.length - 1 &amp;&amp;
        (moment(this.dateList[i + 1].AttendanceDate).day() &#x3D;&#x3D; 0 ||
          (moment(this.dateList[i].AttendanceDate).date() &#x3D;&#x3D; 15 &amp;&amp;
            moment(this.dateList[i].AttendanceDate).day() !&#x3D; 0))
      ) {
        curWeek++;
        weeklyData[curWeek] &#x3D; [];
      }
    }

    console.log(&quot;HOnestly&quot;, weeklyData);

    return weeklyData;
  }

  checkDateCurMonth(calDate) {
    let curMonth &#x3D; moment(this.listheaderDate).get(&quot;month&quot;);
    let calDateMonth &#x3D; moment(calDate).get(&quot;month&quot;);
    if (curMonth !&#x3D; calDateMonth) {
      return true;
    } else {
      return false;
    }
  }

  calculateWeeklyTime(week) {
    if (this.weeklyDataList) {
      let curWeekData &#x3D; this.weeklyDataList[week];
      let totalMinutes &#x3D; 0;
      curWeekData.forEach(el &#x3D;&gt; {
        totalMinutes +&#x3D; el.MinutesConsidered;
      });
      this.weeklyTotal.minutes &#x3D; Math.round(totalMinutes % 60).toString();
      this.weeklyTotal.hours &#x3D; Math.floor(totalMinutes / 60).toString();
      return {
        hours: this.weeklyTotal.hours,
        minutes: this.weeklyTotal.minutes
      };
    }
  }
  //abcd
  markAttendance() {
    this.openStatus &#x3D; !this.openStatus;
    const tempdate &#x3D; new Date(this.startDate);
    const month &#x3D; tempdate.getMonth() + 1;
    const newDate &#x3D;
      tempdate.getFullYear() + &quot;-&quot; + month + &quot;-&quot; + tempdate.getDate();
    this._services.encrypt(this.latitude.toString()).then(lat &#x3D;&gt; {
      console.log(&quot;encrypted lat: &quot;, lat);
      this._services.encrypt(this.longitude.toString()).then(long &#x3D;&gt; {
        console.log(&quot;encrypted long: &quot;, long);
        /*let param &#x3D; {
          &quot;lst&quot;: [
            {
              // &quot;TokenNo&quot;: this._storage.get(&#x27;username&#x27;).TokenId,
              &quot;TokenNo&quot;: this.localUserData.TokenId,
              &quot;AttendanceDate&quot;: newDate,
              &quot;AttendanceTime&quot;: this.startDate,
              &quot;TimeType&quot;: this.signInType,
              &quot;MachineID&quot;: &quot;&quot;,
              &quot;Lat&quot;: lat,
              &quot;Long&quot;: long,
              &quot;Source&quot;: 2,
              // &quot;CreatedBy&quot;: this._storage.get(&#x27;username&#x27;).TokenId
              &quot;CreatedBy&quot;: this.localUserData.TokenId
            }],
          &quot;tokenid&quot;: this.localUserData.TokenId
        }*/
        let param &#x3D; {
          TimeType: this.signInType,
          MachineID: &quot;&quot;,
          Lat: lat,
          Long: long,
          Source: 2,
          tokenid: this.localUserData.TokenId
        };
        console.log(param);
        this.spinnerService.show();
        this._services.postService(Constant.marksCheckInAttendance, param).then(
          (data: any) &#x3D;&gt; {
            console.log(param);
            this.spinnerService.hide();
            let type &#x3D; this.signInType &#x3D;&#x3D;&#x3D; &quot;O&quot; ? &quot;Punch Out&quot; : &quot;Punch In&quot;;
            this.successMessage &#x3D;
              &quot;Your &quot; +
              type +
              &quot; for &quot; +
              moment(data.PunchedTime).format(&quot;DD-MMM-YYYY HH:mm:ss&quot;) +
              &quot; was Successful!&quot;;
            // this.response &#x3D; ;
            $(&quot;#mapModal&quot;).modal(&quot;hide&quot;);
            $(&quot;#successModal&quot;).modal(&quot;show&quot;);
            this.checkMarkAttendanceType();
            // setTimeout(function () {
            // window.location.reload();
            // }, 1800);
          },
          error &#x3D;&gt; {
            this.spinnerService.hide();
            this.response &#x3D; error;
            $(&quot;#mapModal&quot;).modal(&quot;hide&quot;);
            $(&quot;#successModal&quot;).modal(&quot;show&quot;);
          }
        );
      });
    });
  }

  checkMarkAttendance() {
    this.openStatus &#x3D; !this.openStatus;

    // let date &#x3D; moment(this.startDate).date();
    // let month &#x3D; moment(this.startDate).month();
    // let year &#x3D; moment(this.startDate).year();
    // let current_date &#x3D; year + &quot;-&quot; + (month + 1) + &quot;-&quot; + date;

    // const param &#x3D; JSON.stringify({
    //   // &quot;tokenid&quot;: this._storage.get(&#x27;username&#x27;).TokenId,
    //   &quot;tokenid&quot;: this.localUserData.TokenId,
    //   &quot;AttendanceDate&quot;: current_date
    // });
    // this._services.postService(Constant.getPunchData, param).then((data: any) &#x3D;&gt; {
    //   console.log(data);
    //   if (data.TimeType &#x3D;&#x3D; null) {
    //     // $(&quot;#conformationModal&quot;).modal(&#x27;show&#x27;);
    //     this.openFooter &#x3D; !this.openFooter
    //   }
    //   if (data.TimeType &#x3D;&#x3D; &#x27;O&#x27; &amp;&amp; this.signInType &#x3D;&#x3D; &#x27;I&#x27;) {
    //     // $(&quot;#conformationModal&quot;).modal(&#x27;show&#x27;);
    //     this.openFooter &#x3D; !this.openFooter
    //   }
    //   if (data.TimeType &#x3D;&#x3D; &#x27;O&#x27;) {
    //     // $(&quot;#conformationModal&quot;).modal(&#x27;show&#x27;);
    //     this.openFooter &#x3D; !this.openFooter
    //   }
    //   if (data.TimeType &#x3D;&#x3D; &#x27;I&#x27;) {
    //     // $(&quot;#conformationModal&quot;).modal(&#x27;show&#x27;);
    //     this.openFooter &#x3D; !this.openFooter
    //   }
    // }, (error) &#x3D;&gt; {
    //   console.log(error);
    // });
  }
  closePanel() {
    this.openStatus &#x3D; !this.openStatus;
  }
  checkMarkAttendanceType() {
    let date &#x3D; moment(this.startDate).date();
    let month &#x3D; moment(this.startDate).month();
    let year &#x3D; moment(this.startDate).year();
    let current_date &#x3D; year + &quot;-&quot; + (month + 1) + &quot;-&quot; + date;
    const param &#x3D; JSON.stringify({
      // &quot;tokenid&quot;: this._storage.get(&#x27;username&#x27;).TokenId,
      tokenid: this.localUserData.TokenId,
      AttendanceDate: current_date
    });
    this._services.postService(Constant.getPunchData, param).then(
      (data: any) &#x3D;&gt; {
        //  this._services.spinnerService.hide()
        // this.isMarkAttendanceAllowed &#x3D; data.Status !&#x3D;&#x3D; null &amp;&amp; data.Status !&#x3D;&#x3D; &#x27;pending&#x27;;
        if (data.TimeType &#x3D;&#x3D; null) {
          this.attendanceType &#x3D; &quot;Punch In&quot;;
          this.signInType &#x3D; &quot;I&quot;;
        }
        if (data.TimeType &#x3D;&#x3D; &quot;I&quot;) {
          this.attendanceType &#x3D; &quot;Punch Out&quot;;
          this.signInType &#x3D; &quot;O&quot;;
        }
        if (data.TimeType &#x3D;&#x3D; &quot;O&quot;) {
          this.attendanceType &#x3D; &quot;Punch Out&quot;;
          this.signInType &#x3D; &quot;O&quot;;
        }
        //this.spinnerService.hide();
      },
      error &#x3D;&gt; {
        this.spinnerService.hide();
        console.log(error);
      }
    );
  }

  msToTime(duration) {
    let seconds &#x3D; Math.floor(duration / 1000) % 60;
    let minutes &#x3D; Math.floor(duration / (1000 * 60)) % 60;
    let hours &#x3D; Math.floor(duration / (1000 * 60 * 60)) % 24;

    let hours1 &#x3D; hours &lt; 10 ? &quot;0&quot; + hours : hours;
    let minutes1 &#x3D; minutes &lt; 10 ? &quot;0&quot; + minutes : minutes;
    let seconds1 &#x3D; seconds &lt; 10 ? &quot;0&quot; + seconds : seconds;

    return hours1 + &quot;:&quot; + minutes1 + &quot;:&quot; + seconds1;
  }

  TimeMinutes(n) {
    let num &#x3D; n;
    let hours &#x3D; num / 60;
    let rhours &#x3D; Math.floor(hours);
    let minutes &#x3D; (hours - rhours) * 60;
    let rminutes &#x3D; Math.round(minutes);
    let hours1 &#x3D; rhours &lt; 10 ? &quot;0&quot; + rhours : rhours;
    let minutes1 &#x3D; rminutes &lt; 10 ? &quot;0&quot; + rminutes : rminutes;
    return hours1 + &quot;:&quot; + minutes1;
    //return rhours + &quot;:&quot; + rminutes + &quot;:&quot; + &#x27;00&#x27;;
  }

  MinutesConsidered(data) {
    let data1 &#x3D; this.TimeMinutes(data);
    return data1;
  }

  showInfo(dateInfo: any) {
    // console.log(&quot;dateInfo&quot;,dateInfo)
    //  alert(&#x27;Hello&#x27;)
    //  alert(&#x27;Date Info&#x27; + JSON.stringify(dateInfo));

    let date &#x3D; moment(this.startDate).date();
    let month &#x3D; moment(this.startDate).month();
    let year &#x3D; moment(this.startDate).year();

    let calendarDate &#x3D; moment(dateInfo.AttendanceDate).date();
    const calendarMonth &#x3D; moment(dateInfo.AttendanceDate).month();
    let calendarYear &#x3D; moment(dateInfo.AttendanceDate).year();
    const current_date &#x3D; year + &quot;-&quot; + (month + 1) + &quot;-&quot; + date;

    let clockedHours &#x3D; &quot;&quot;;
    // if ((dateInfo.TimeIn &amp;&amp; dateInfo.TimeOut) &amp;&amp; this.localUserData.isHOEmp !&#x3D;&#x3D; true) {
    //   console.dir(&#x27;inside calTime&#x27;);
    //   clockedHours &#x3D; this.msToTime(new Date(dateInfo.TimeOut).getTime() - new Date(dateInfo.TimeIn).getTime());
    //   dateInfo[&#x27;clockedHours&#x27;]&#x3D;clockedHours;
    // }
    if (dateInfo.MinutesConsidered !&#x3D; null &amp;&amp; dateInfo.MinutesConsidered !&#x3D; 0) {
      console.dir(&quot;inside Ho&quot;);
      clockedHours &#x3D; this.TimeMinutes(dateInfo.MinutesConsidered);
      dateInfo[&quot;clockedHours&quot;] &#x3D; clockedHours;
    }
    // if ((date &#x3D;&#x3D;&#x3D; calendarDate) &amp;&amp; (month &#x3D;&#x3D;&#x3D; calendarMonth) &amp;&amp; (year &#x3D;&#x3D;&#x3D; calendarYear)) {

    //   let url &#x3D; Constant.getPunchDataForApp;
    //   let param &#x3D; {
    //     &quot;AttendanceDate&quot;: current_date,
    //     &quot;tokenid&quot;: this._storage.get(&#x27;username&#x27;).TokenId
    //   };
    //   // alert(param)
    //   this._services.postService(url, param)
    //     .then((response: any) &#x3D;&gt; {
    //       console.log(&#x27;RESPONSEEEEE&#x27;, response);
    //       if (response.data.length !&#x3D; 0) {

    //         this.attendanceInfo &#x3D; response.data[0];
    //         this.noRecord &#x3D; true;
    //       }
    //       else {
    //         this.attendanceInfo &#x3D; dateInfo;
    //         this.noRecord &#x3D; true;
    //       }
    //     });

    // }
    // else {

    if (dateInfo.Status !&#x3D; &quot;H&quot;) {
      this.attendanceInfo &#x3D; dateInfo;
      this.noRecord &#x3D; true;
    } else {
      if (dateInfo.Status &#x3D;&#x3D; &quot;H&quot; || dateInfo.Status &#x3D;&#x3D; &quot;H&quot;) {
        this.detailsIcon &#x3D; &quot;assets/img/week-off.png&quot;;
        this.defaultMsg &#x3D; dateInfo.StatusDescription;
        this.noRecord &#x3D; false;
      } else {
        this.detailsIcon &#x3D; &quot;&quot;;
        this.defaultMsg &#x3D; &quot;&quot;;
        this.noRecord &#x3D; true;
      }
      this.attendanceInfo &#x3D; null;
    }
    console.log(&quot;ATTENDANCE INFO&quot;, this.attendanceInfo);

    //}
  }

  getCalendarEvent(getDateMonthCall) {
    let temp_month &#x3D; parseInt(this.tempMonth) + 1;
    // const tokenid &#x3D; this._storage.get(&#x27;username&#x27;).TokenId;
    const tokenid &#x3D; this.localUserData.TokenId;

    this.saveDaysMonth &#x3D;
      moment(temp_month, &quot;MM&quot;).format(&quot;MMMM&quot;) + &quot; &quot; + this.year;
    this.saveDaysMonthList &#x3D;
      moment(temp_month, &quot;MM&quot;).format(&quot;MMMM&quot;) + &quot; &quot; + this.year;
    const data &#x3D; { month: temp_month, year: this.year, tokenid: tokenid };
    console.log(&quot;new calendarEventdata&quot;, data);
    this.spinnerService.show();
    this._services.postService(Constant.MonthAttendanceNew, data).then(
      (response: any) &#x3D;&gt; {

        this.showCaleInfo &#x3D; true;
        this.toggleButton &#x3D; true;
        this.monthWiseHolidays &#x3D; [];
        this.monthDetail &#x3D; response.data;
        this.weeklyData &#x3D; this.weeklySegregation();
        console.log(&quot;FROMMMMM&quot;, this.weeklyData);
        this.spinnerService.hide();
        this.getHolidayList(this.monthDetail);
        this.applyDateAll();
        //this.spinnerService.hide();
        getDateMonthCall();
        //this.applyDate();
      },
      error &#x3D;&gt; {
        this.spinnerService.hide();
        console.log(error.status);
        // this._services.showSnackbar(error);
      }
    );
  }

  //get month details
  getMonthDetail(year, month) {
    let temp_month &#x3D; parseInt(month) + 1;
    // const tokenid &#x3D; this._storage.get(&#x27;username&#x27;).TokenId;
    const tokenid &#x3D; this.localUserData.TokenId;
    const data &#x3D; { month: temp_month, year: year, tokenid: tokenid };
    console.log(year + &quot;|&quot; + month + &quot;|&quot; + Constant.MonthWiseAttendance);
    console.log(&quot;data: &quot;, data);
    this.spinnerService.show();
    this._services.postService(Constant.MonthWiseAttendance, data).then(
      (response: any) &#x3D;&gt; {
        console.log(&quot;MONTHHHH&quot;, response);

        this.spinnerService.hide();
        this.showCaleInfo &#x3D; true;
        this.toggleButton &#x3D; true;
        this.monthDetail &#x3D; response.data;
      },
      error &#x3D;&gt; {
        console.log(error.status);
        this.spinnerService.hide();
        // this._services.showSnackbar(error);
      }
    );
  }
  getLatLong(latitude, longitude) {
    if (latitude &#x3D;&#x3D; null || longitude &#x3D;&#x3D; null) {
      this._services.showSnackbar({ status: &quot;No Map data Available.&quot; });

      this.noMapAvailable &#x3D; true;
    } else if (latitude !&#x3D;&#x3D; null &amp;&amp; longitude !&#x3D;&#x3D; null) {
      if (navigator.geolocation) {
        const getId &#x3D; latitude &#x3D;&#x3D; &quot;&quot; ? &quot;map&quot; : &quot;attendancemap&quot;;

        const div &#x3D; document.getElementById(getId);
        navigator.geolocation.getCurrentPosition(
          position &#x3D;&gt; {
            this.isPermissionSet &#x3D; true;
            this.noMapAvailable &#x3D; true;
            this.isMapAvailable &#x3D; true;
            this.latitude &#x3D;
              latitude &#x3D;&#x3D; &quot;&quot; ? position.coords.latitude : parseFloat(latitude);
            this.longitude &#x3D;
              longitude &#x3D;&#x3D; &quot;&quot;
                ? position.coords.longitude
                : parseFloat(longitude);

            console.log(&quot;THIS&gt;&quot;, this.latitude);

            console.log(&quot;THIS&gt;&quot;, this.longitude);
            let mapFrame &#x3D; &#x60;&lt;iframe width&#x3D;&quot;100%&quot; height&#x3D;&quot;90%&quot; frameborder&#x3D;&quot;0&quot; style&#x3D;&quot;border:0&quot; src&#x3D;&quot;${Constant.embedMapURL}&amp;q&#x3D;${this.latitude},${this.longitude}&quot; allowfullscreen&gt;&lt;/iframe&gt;&#x60;;
            console.log(mapFrame);
            div.innerHTML &#x3D; mapFrame;
            // const map &#x3D; new google.maps.Map(div, {
            //   center: {
            //     lat: this.latitude,
            //     lng: this.longitude
            //   },
            //   draggable: false,
            //   zoom: 18
            // });
            // const marker &#x3D; new google.maps.Marker({
            //   position: new google.maps.LatLng(this.latitude, this.longitude),
            //   map: map,

            //   title: &#x27;You are here!&#x27;
            // });
          },
          error &#x3D;&gt; {
            this.setGeolocationErrorMsg(error);
            $(&quot;#successModal&quot;).modal(&quot;show&quot;);
          },
          { enableHighAccuracy: true, maximumAge: 50000 }
        );
      } else {
        //alert(&quot;Not set map&quot;);
      }
    }
  }

  // Marks attendance
  marksSignIn() {
    this.checkMarkAttendance();
    // this.signInType &#x3D; &#x27;I&#x27;;
    const tempdate &#x3D; new Date(this.signinTime);
    const month &#x3D; tempdate.getMonth() + 1;
    const newDate &#x3D;
      tempdate.getFullYear() + &quot;-&quot; + month + &quot;-&quot; + tempdate.getDate();
    let param &#x3D; {
      lst: [
        {
          // &quot;TokenNo&quot;: this._storage.get(&#x27;username&#x27;).TokenId,
          TokenNo: this.localUserData.TokenId,
          AttendanceDate: newDate,
          AttendanceTime: this.signinTime,
          TimeType: this.signInType,
          MachineID: &quot;&quot;,
          Lat: parseFloat(this.latitude),
          Long: parseFloat(this.longitude),
          Source: 2,
          CreatedBy: this.localUserData.TokenId
          // &quot;CreatedBy&quot;: this._storage.get(&#x27;username&#x27;).TokenId
        }
      ]
    };

    this._services.postService(Constant.marksCheckInAttendance, param).then(
      data &#x3D;&gt; {
        $(&quot;#mapModal&quot;).modal(&quot;hide&quot;);
        $(&quot;#successModal&quot;).modal(&quot;show&quot;);
        window.location.reload();
      },
      error &#x3D;&gt; {
        $(&quot;#mapModal&quot;).modal(&quot;hide&quot;);
        $(&quot;#successModal&quot;).modal(&quot;show&quot;);
      }
    );
  }

  getHolidayList(monthDetail) {
    for (let i &#x3D; 0; i &lt; monthDetail.length; i++) {
      if (
        monthDetail[i].HolidayDescription !&#x3D; &quot;&quot; &amp;&amp;
        monthDetail[i].IsHoliday &amp;&amp;
        monthDetail[i].HolidayDescription !&#x3D; null
      ) {
        this.monthWiseHolidays.push({
          date: monthDetail[i].AttendanceDate,
          holidaydesc: monthDetail[i].HolidayDescription,
          holidayType: monthDetail[i].Status
        });
      }
    }
  }

  // calendarView

  leaveViewFun() {
    this.leaveView &#x3D; true;
    this.calendarView &#x3D; false;
    this.listView &#x3D; false;
    this.regularizeView &#x3D; false;

    const sideSection &#x3D; &lt;HTMLDivElement&gt;document.querySelector(&quot;.side-section&quot;);
    const mainsection &#x3D; &lt;HTMLDivElement&gt;(
      document.querySelector(&quot;.attendance-section&quot;)
    );
    sideSection.style.display &#x3D; &quot;none&quot;;
    this.leaveCardClassActive &#x3D; false;
    this.leaveReqClassActive &#x3D; false;
    this.leaveListClassActive &#x3D; true;
    $(&quot;document&quot;).ready(function () {
      $(&quot;#leaveReq&quot;).click();
    });

    // for(var i&#x3D;0;i&lt;&#x3D;30;i++){
    //   this.leaveCardArr.push({&#x27;leaveType&#x27;:&#x27;leave-Balance&#x27;,&#x27;PL&#x27;:5,&#x27;EL&#x27;:5,&#x27;ML&#x27;:10});
    // }

    this.leaveCard &#x3D; [
      {
        leaveName: &quot;Derived Balance-2017&quot;,

        PL: &quot;15.0&quot;,

        EL: &quot;0.0&quot;,

        ML: &quot;0.0&quot;
      },

      {
        leaveName: &quot;Lapsed-2017&quot;,

        PL: &quot;0.0&quot;,

        EL: &quot;0.0&quot;,

        ML: &quot;0.0&quot;
      },

      {
        leaveName: &quot;Closing Balance-2017&quot;,

        PL: &quot;15.0&quot;,

        EL: &quot;0.0&quot;,

        ML: &quot;0.0&quot;
      },

      {
        leaveName: &quot;Credit for the 2018&quot;,

        PL: &quot;20.0&quot;,

        EL: &quot;17.0&quot;,

        ML: &quot;10.0&quot;
      },

      {
        leaveName: &quot;Opening Balance-2018&quot;,

        PL: &quot;35.0&quot;,

        EL: &quot;17.0&quot;,

        ML: &quot;10.0&quot;
      },

      {
        leaveName: &quot;Approved/Sanctioned-2018&quot;,

        PL: &quot;0.0&quot;,

        EL: &quot;10.5&quot;,

        ML: &quot;6.0&quot;
      },

      {
        leaveName: &quot;Encashed 2018&quot;,

        PL: &quot;0.0&quot;,

        EL: &quot;0.0&quot;,

        ML: &quot;0.0&quot;
      },

      {
        leaveName: &quot;Balance as on date&quot;,

        PL: &quot;35.0&quot;,

        EL: &quot;6.5&quot;,

        ML: &quot;4.0&quot;
      }
    ];
  }

  calendarview() {
    this.calendarView &#x3D; true;
    this.listView &#x3D; false;
    this.leaveView &#x3D; false;
    this.regularizeView &#x3D; false;
    const sideSection &#x3D; &lt;HTMLDivElement&gt;document.querySelector(&quot;.side-section&quot;);
    const mainsection &#x3D; &lt;HTMLDivElement&gt;(
      document.querySelector(&quot;.attendance-section&quot;)
    );
    sideSection.style.display &#x3D; &quot;block&quot;;
    //this.applyDate();
    this.applyDateAll();
  }

  listview() {
    const sideSection &#x3D; &lt;HTMLDivElement&gt;document.querySelector(&quot;.side-section&quot;);
    const mainsection &#x3D; &lt;HTMLDivElement&gt;(
      document.querySelector(&quot;.attendance-section&quot;)
    );
    sideSection.style.display &#x3D; &quot;none&quot;;
    //this.applyDateList();
    this.applyDateAll();
    this.listView &#x3D; true;
    this.calendarView &#x3D; false;
    this.regularizeView &#x3D; false;
    this.leaveView &#x3D; false;

    this.attendanceInfo &#x3D; null;
  }

  ngOnDestroy() {
    $(&quot;#successModal&quot;).modal(&quot;hide&quot;);
    this.spinnerService.hide();
  }

  attendanceRegularize() {
    const sideSection &#x3D; &lt;HTMLDivElement&gt;document.querySelector(&quot;.side-section&quot;);
    const mainsection &#x3D; &lt;HTMLDivElement&gt;(
      document.querySelector(&quot;.attendance-section&quot;)
    );
    sideSection.style.display &#x3D; &quot;block&quot;;

    let data &#x3D; {
      // TokenId: this._storage.get(&#x27;username&#x27;).TokenId
      TokenId: this.localUserData.TokenId
      //24003466
    };
    this.reasonText &#x3D; &quot;&quot;;
    this.listView &#x3D; false;
    this.calendarView &#x3D; false;
    this.leaveView &#x3D; false;
    this.regularizeView &#x3D; true;
    this.spinnerService.show();
    this._services
      .postService(Constant.GetPendingAttendance, data)
      .then(resp &#x3D;&gt; {
        console.log(resp);

        this.pendingAttendance &#x3D; resp;

        $(&quot;document&quot;).ready(function () {
          $(&quot;#poof0&quot;).slideDown(&quot;slow&quot;);
          this.oldIndex &#x3D; 0;
        });

        this.spinnerService.hide();
      });
  }

  openConfirmation(flag, obj, innerobj) {
    this.obj &#x3D; obj;
    this.innerobj &#x3D; innerobj;
    this.flag &#x3D; flag;
    console.log(&quot;this.flag&quot;, this.flag);
    this.status &#x3D; flag &#x3D;&#x3D;&#x3D; &quot;Approved&quot; ? &quot;Approval&quot; : &quot;Rejection&quot;;
    console.log(&quot;this.status&quot;, this.status);

    setTimeout(() &#x3D;&gt; {
      $(&quot;#confirmationAttendance&quot;).modal(&quot;show&quot;);
    }, 500);
  }

  approveReject() {
    if (this.reasonText.trim() !&#x3D; &quot;&quot;) {
      let url &#x3D; Constant.ApproveRejectAttendance;
      this.innerobj.Status &#x3D; this.flag;
      // this.innerobj.Remarks &#x3D; &#x27;&#x27;;
      this.innerobj.Remarks &#x3D; this.reasonText;
      let data &#x3D; {
        TokenId: this.obj.TokenId,
        AttendanceEntries: [this.innerobj]
      };

      console.log(&quot;data&quot;, data);

      this._services.postService(url, data).then(resp &#x3D;&gt; {
        if (resp &#x3D;&#x3D; &quot;Success&quot;) {
          $(&quot;#confirmationAttendance&quot;).modal(&quot;hide&quot;);
          this._services.showSnackbar({
            status: &quot;Attendace &quot; + this.flag + &quot; Successfully&quot;
          });
          this.attendanceRegularize();
        }
      });
    } else {
      this._services.showSnackbar({ status: &quot;Reason field is mandatory&quot; });
    }
  }
  toggle(i, flag) {
    for (var j &#x3D; 0; j &lt; this.pendingAttendance.length; j++) {
      i !&#x3D; j
        ? $(&quot;#poof&quot; + j).slideUp(&quot;slow&quot;)
        : $(&quot;#poof&quot; + i).slideToggle(&quot;slow&quot;);
    }
    this.oldIndex &#x3D;&#x3D; i
      ? (this.oldIndex &#x3D; this.pendingAttendance.length)
      : (this.oldIndex &#x3D; i);
  }
  openTimeOffDialog(attendanceInfo) {
    console.log(&quot;kavita&quot;, attendanceInfo);
    this.regularizeData.date &#x3D; attendanceInfo.AttendanceDate;
    this.regularizeData.shiftBegin &#x3D; attendanceInfo.TimeIn;
    this.regularizeData.shiftEnd &#x3D; attendanceInfo.TimeOut;
    this.regularizeData.inTime &#x3D; &quot;&quot;;
    this.regularizeData.outTime &#x3D; &quot;&quot;;
    this.regularizeData.remarks &#x3D; &quot;Your remarks&quot;;
    $(&quot;#timeoffModal&quot;).modal(&quot;show&quot;);
  }
  getDate(datetime) {
    if (!datetime) {
      return null;
    }
    return datetime.substring(0, 10);
  }
  getTime(datetime) {
    if (!datetime) {
      return null;
    }
    return datetime
      .toLowerCase()
      .split(&quot;t&quot;)
      .pop()
      .substring(0, 5);
  }
  regularizeSubmit() {
    console.log(&quot;kavi&quot;, this.regularizeData);
    let regularizationDate &#x3D; this.dateFormat(this.regularizeData.date);
    let regularizeInTime &#x3D; this.dateFormat(
      this.getDate(this.regularizeData.date) + &quot; &quot; + this.regularizeData.inTime
    );
    let regularizeOutTime &#x3D; this.dateFormat(
      this.getDate(this.regularizeData.date) + &quot; &quot; + this.regularizeData.outTime
    );
    let actualInTime &#x3D; this.dateFormat(this.regularizeData.shiftBegin);
    actualInTime &#x3D;
      actualInTime &#x3D;&#x3D;&#x3D; &quot;Invalid date&quot; ? regularizationDate : actualInTime;
    let actualOutTime &#x3D; this.dateFormat(this.regularizeData.shiftEnd);
    actualOutTime &#x3D;
      actualOutTime &#x3D;&#x3D;&#x3D; &quot;Invalid date&quot; ? regularizationDate : actualOutTime;
    // const tokenid &#x3D; this._storage.get(&#x27;username&#x27;).TokenId;
    const tokenid &#x3D; this.localUserData.TokenId;
    const data &#x3D; {
      TokenID: tokenid,
      RegularizationDate: regularizationDate,
      ActualInTime: actualInTime,
      ActualOutTime: actualOutTime,
      RegularizationInTime: regularizeInTime,
      RegularizationOutTime: regularizeOutTime,
      Remarks: this.regularizeData.remarks
    };
    console.log(data);
    // return false;
    this.spinnerService.show();
    this._services.postService(Constant.regularizeAttendance, data).then(
      (response: any) &#x3D;&gt; {
        this.spinnerService.hide();
        this._services.showSnackbar({
          status: &quot;Attendace successfully regularized&quot;
        });
        $(&quot;#timeoffModal&quot;).modal(&quot;hide&quot;);
      },
      error &#x3D;&gt; {
        this.spinnerService.hide();
        console.log(error.status);
      }
    );
  }
  validateRegularize() {
    if (
      !this.regularizeData.inTime ||
      !this.regularizeData.outTime ||
      !this.regularizeData.remarks
    ) {
      return true;
    } else {
      return false;
    }
  }
  dateFormat(date) {
    return moment(date).format();
  }

  formCntrl(controlName) {
    return this.leaveRequest.get(controlName);
  }
  activeClassChange(val) {
    this.leaveListClassActive &#x3D; false;
    this.leaveReqClassActive &#x3D; false;
    this.leaveCardClassActive &#x3D; false;
    if (val &#x3D;&#x3D; &quot;leaveList&quot;) {
      this.leaveListClassActive &#x3D; true;
    } else if (val &#x3D;&#x3D; &quot;leaveReq&quot;) {
      this.leaveReqClassActive &#x3D; true;
    } else {
      this.leaveCardClassActive &#x3D; true;
    }
  }
}
</code></pre>
    </div>
</div>



                   




                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> result-matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'class';
            var COMPODOC_CURRENT_PAGE_URL = 'RegularizeModalData-1.html';
            var MAX_SEARCH_RESULTS = 15;
       </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>
       <!-- Required to polyfill modern browsers as code is ES5 for IE... -->
       <script src="../js/libs/custom-elements-es5-adapter.js" charset="utf-8" defer></script>
       <script src="../js/menu-wc.js" defer></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>
       <script src="../js/libs/zepto.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
          <script src="../js/search/search.js"></script>
          <script src="../js/search/lunr.min.js"></script>
          <script src="../js/search/search-lunr.js"></script>
          <script src="../js/search/search_index.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
